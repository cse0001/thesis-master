\begin{algorithm}[htbp]
	\caption{构建系统级软件包依赖图 (S-PDG)}
	\label{alg:BuildSPDG}
	\begin{algorithmic}[1]
		\REQUIRE apt directory, pip directory
		\ENSURE System-level Package Dependency Graph (S-PDG)
		
		\STATE {\bfseries Step1: Collect packages from apt and pip directories:}
		\STATE $apt\_pkg$ = get\_packages\_from\_apt\_dir(apt directory)
		\STATE $pip\_pkg$ = get\_packages\_from\_pip\_dir(pip directory)
		
		\STATE {\bfseries Step2: Build R-PDG:}
		\STATE $apt\_RPDG$ = construct\_RPDG($apt\_pkg$)
		\STATE $pip\_RPDG$ = construct\_RPDG($pip\_pkg$)
		
		\STATE {\bfseries Step3: Merge R-PDGs to construct S-PDG:}
		\STATE Initialize $S\_PDG$ as empty graph
		\FOR{each package $A$ in $apt\_RPDG$}
		\IF{$A$ also exists in $pip\_RPDG$}
		\STATE Add a covered edge in $S\_PDG$ from $A$ in $apt\_RPDG$ to $A$ in $pip\_RPDG$
		\ELSE
		\STATE Add $A$ to $S\_PDG$
		\ENDIF
		\ENDFOR
		\FOR{each package $P$ exclusively in $pip\_RPDG$}
		\STATE Add $P$ to $S\_PDG$
		\ENDFOR
	\end{algorithmic}
\end{algorithm}
